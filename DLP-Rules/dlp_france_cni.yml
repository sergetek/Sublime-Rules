name: "DLP: France National ID Card (CNI) - Any Direction"
description: "Detects messages containing French National ID Card numbers (Carte Nationale d'Identit√©)."
type: "rule"
severity: "high"
source: |
  any([body.current_thread.text, subject.subject],
          // French CNI: 12 digits or alphanumeric
          regex.contains(., '\b[A-Z0-9]{12}\b')
  )
  and any([body.current_thread.text, subject.subject],
          regex.icontains(., 'CNI|carte\s+nationale|national\s+ID')
  )
  and (
    strings.icontains(sender.email.domain.tld, "fr")
    or strings.icontains(body.current_thread.text, "france")
  )

detection_methods:
-   "Content analysis"
